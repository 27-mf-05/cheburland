# Как проходил процесс оптимизации?

## Шаги

1. Замерка производительности приложения при помощи: React Profiler и dev-консоли (замерялся
   путь url пользователя от "/" до "/game")
2. Выявление утечек
3. Оптимизация приложения при помощи хуков: useCallback(), useMemo(). И React.Memo
4. Повторная замерка, чтобы удостовериться в улучшении производительности

## Что было до?

До оптимизации приложение показывало такую производительность и использование памяти:

#### React Profiler -

На фазе mount, actualDuration составил 10.5 мс, а baseDuration 9 мс.

Максимальное значение actualDuration достигает 41.1 мс.

#### dev-консоль

![Screenshot](./images/devOptimisationBefore.png)

## Что стало после?

После оптимизации приложение показывало такие производительность и использование памяти:

#### React Profiler -

На фазе mount, actualDuration составил 9.9 мс, а baseDuration 8.6 мс.

Максимальное actualDuration в 55.4 мс.

#### dev-консоль

![Screenshot](./images/devOptimisationAfter.png)

## Изменения

| Критерий                                                  | До       | После    | Изменение в % |
|-----------------------------------------------------------|----------|----------|---------------|
| Фаза инициализации actualDuration (среднее, без выбросов) | 5.4 мс   | 5.1 мс   | -5.56%        |
| Фаза обновления actualDuration (среднее, без выбросов)    | 5.42 мс  | 6.20 мс  | 14.39%        |
| actualDuration (макс)                                     | 41.1 мс  | 55.4 мс  | 34.70%        |
| actualDuration (мин)                                      | 1.3 мс   | 1.1 мс   | -15.38%       |
| Фаза инициализации baseDuration (среднее, без выбросов)   | 9 мс     | 8.6 мс   | -4.44%        |
| Фаза обновления baseDuration (среднее, без выбросов)      | 37.24 мс | 40.66 мс | 9.18%         |
| baseDuration (макс)                                       | 60.2     | 58.7 мс  | -2.49%        |
| baseDuration (мин)                                        | 5.2      | 5.0 мс   | -3.85%        |
| memory                                                    | 25892    | 17731    | -31.54%       |
| JS Heap                                                   | 18027876 | 17264524 | -4.24%        |
| Documents                                                 | 5        | 3        | -40.00%       |
| NodeJs                                                    | 16775    | 8935     | -46.77%       |
| Listeners                                                 | 339-454  | 348      | -2.11%        |

Время в фазе инициализации actualDuration уменьшилось поле оптимизации на 5.56%, но увеличилось для фазы обновления
на 14.39%.
Максимальное время в фазе обновления для actualDuration увеличилось на 34.7%, а минимальное уменьшилось на 15.37%

Время в фазе инициализации baseDuration уменьшилось поле оптимизации на 4.44%, но увеличилось для фазы обновления
на 9.18%.
Минимальные и максимальные показатели baseDuration в фазе обновления уменьшились соответственно на 2.49% и
3.85%

Если очистить выборку от выбросов, и сравнить среднее значение до и после оптимизации можно сделать вывод о том,
что оба времени в фазе инициализации уменьшились, а в фазе обновления увеличились.

Из данных dev-консоли видно, что оптимизация приложения привела к снижению потребления памяти, количество
документов и слушателей событий было сокращено.

Таким образом оптимизация уменьшила время инициализации и количество затрачиваемой памяти на приложения, 
но увеличила время для обновления. В целом можно сказать, что оптимизация положительно повлияла на приложение.
